var Zanimo=function(){if(!window.requestAnimationFrame)window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();var c=function(a){var b=/(\(.+?\))/g,c=/^0px$/g;_space=/ /g;_normRegex=/\-([a-z])/g;_emptyString="";_transitionend="transitionend";_prefix=null;_prefixed={transform:""};_norm=function(a){return(a[0]==="-"?a.substr(1,a.length-
1):a).replace(_normRegex,function(a,b){return b.toUpperCase()})};_normTransform=function(a){return a.replace(b,function(a){var b=[];a.substr(1,a.length-2).split(",").forEach(function(a){b.push(a.replace(_space,_emptyString).replace(c,"0"))});return"("+b.join(",")+")"})};"WebkitTransition"in a.body.style&&!("OTransition"in a.body.style)&&(_transitionend="webkitTransitionEnd",_prefix="webkit");for(var e in _prefixed)_prefixed[e]=_prefix?"-"+_prefix+"-"+e:e;return{t:_norm(_prefix?_prefix+"-transition":
"transition"),transitionend:_transitionend,norm:_norm,prefix:function(a){return _prefixed[a]?_prefixed[a]:a},repr:function(a,b,c){return a+" "+b+"ms "+(c||"linear")},normTransform:_normTransform}}(window.document),d=function(a){return Q.fcall(function(){return a})},k=function(a,b,h,e,d){b=c.prefix(b);a.style[c.t]=a.style[c.t]?a.style[c.t]+", "+c.repr(b,e,d):c.repr(b,e,d);a.style[c.norm(b)]=h},l=function(a,b,h,e,d){var b=c.prefix(b),h=a.style[c.t].split(", "),f=h.lastIndexOf(c.repr(b,e,d)),b=h.filter(function(a,
b){return b!==f});a.style[c.t]=b.toString()};d.transition=function(a,b,d,e,g){var f=Q.defer(),i,j=function(){i&&(clearTimeout(i),i=null);l(a,b,d,e,g);a.removeEventListener(c.transitionend,j,!1);f.resolve(a)};if(!a||!a.nodeType||!(a.nodeType>=0))return f.reject(Error("Zanimo transition: no DOM element!")),f.promise;a.addEventListener(c.transitionend,j,!1);window.requestAnimationFrame(function(){k(a,b,d,e,g);i=setTimeout(function(){var e=c.normTransform(a.style[c.prefix(b)]),g=c.normTransform(d);e==
g?(j(),f.resolve(a)):f.reject(Error("Zanimo transition: "+a.id+" with "+b+":"+g+" DOM value: ["+e+"]"))},e+20)},a);return f.promise};d.transitionf=function(a,b,c,e){return function(g){return d.transition(g,a,b,c,e)}};d.transform=function(a,b){var d=Q.defer();window.requestAnimationFrame(function(){a.style[c.prefixed.transform]=b;d.resolve(a)},a);return d.promise};d.transformf=function(a){return function(b){return d.transform(b,a)}};d.f=function(a){return function(){return d(a)}};return d}();
