var Zanimo=function(){if(!window.requestAnimationFrame)window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)}}();var c=function(a){var b=/(\(.+?\))/g,c=/^0px$/g;_space=/ /g;_normRegex=/\-([a-z])/g;_emptyString="";_transitionend="transitionend";_prefix=null;_prefixed={transform:""};_normReplacef=function(a,b){return b.toUpperCase()};_normTransf=
function(a){var b=[];a.substr(1,a.length-2).split(",").forEach(function(a){b.push(a.replace(_space,_emptyString).replace(c,"0"))});return"("+b.join(",")+")"};_norm=function(a){return(a[0]==="-"?a.substr(1,a.length-1):a).replace(_normRegex,_normReplacef)};_normTransform=function(a){return isNaN(a)?a.replace(b,_normTransf):a};"WebkitTransition"in a.body.style&&!("OTransition"in a.body.style)&&(_transitionend="webkitTransitionEnd",_prefix="webkit");for(var d in _prefixed)_prefixed[d]=_prefix?"-"+_prefix+
"-"+d:d;return{t:_norm(_prefix?_prefix+"-transition":"transition"),transitionend:_transitionend,norm:_norm,prefix:function(a){return _prefixed[a]?_prefixed[a]:a},repr:function(a,b,c){return a+" "+b+"ms "+(c||"linear")},normTransform:_normTransform}}(window.document),e=function(a){return a instanceof HTMLElement?Q.resolve(a):Q.reject(Error("Zanimo require an HTMLElement"))},i=function(a,b,f,d,e){b=c.prefix(b);a.style[c.t]=a.style[c.t]?a.style[c.t]+", "+c.repr(b,d,e):c.repr(b,d,e);a.style[c.norm(b)]=
f},k=function(a,b,f,d,e){var b=c.prefix(b),f=a.style[c.t].split(", "),g=f.lastIndexOf(c.repr(b,d,e)),b=f.filter(function(a,b){return b!==g});a.style[c.t]=b.toString()};e.transition=function(a,b,f,d,e){var g=Q.defer(),h,j=function(){h&&(clearTimeout(h),h=null);k(a,b,f,d,e);a.removeEventListener(c.transitionend,j,!1);g.resolve(a)};if(!a||!a.nodeType||!(a.nodeType>=0))return g.reject(Error("Zanimo transition: no DOM element!")),g.promise;a.addEventListener(c.transitionend,j,!1);window.requestAnimationFrame(function(){i(a,
b,f,d,e);h=setTimeout(function(){var d=a.style.getPropertyValue(c.prefix(b)),d=c.normTransform(d),e=c.normTransform(f);d==e?(j(),g.resolve(a)):g.reject(Error("Zanimo transition: "+a.id+" with "+b+" = "+e+", DOM value = "+d))},d+20)},a);return g.promise};e.transitionf=function(a,b,c,d){return function(i){return e.transition(i,a,b,c,d)}};e.transform=function(a,b,e){var d=Q.defer();window.requestAnimationFrame(function(){a.style[c.prefixed.transform]=e?a.style[c.prefixed.transform]+b:b;d.resolve(a)},
a);return d.promise};e.transformf=function(a,b){return function(c){return e.transform(c,a,b)}};e.f=function(a){return function(){return e(a)}};return e}();
